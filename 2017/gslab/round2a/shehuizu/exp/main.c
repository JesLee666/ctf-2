#include <string.h>
#include <stdio.h>
#include "forcecrc32.h"

unsigned char ida_chars[] = "\x44\x88\x7d\x38\x6d\x08\xae\xba\xbc\x0e\xf0\xbf\xd1\xda\x27\x1e\x21\x8f\x49\xcb\x4d\x5d\x3c\x39\x45\x85\x3e\xdd\x40\x07\x85\x6c\x51\x67\x78\xb9\xad\xc8\xa6\xaf\x97\x5f\xcd\xb5\xe1\x35\xc2\x48\x3f\xad\x6c\x04\x50\xec\xe3\x2c\x66\xc1\x04\xf9\x9c\x43\x02\xd4\x8e\x09\x41\xb6\x3c\x75\xce\xec\x1b\x03\xc6\xb9\x17\x7f\x38\x0d\x19\xd9\xa2\x42\xc8\x6b\x19\xaa\x2f\x6a\xae\xfa\xe0\x6e\x29\x4c\x8c\x1e\x1b\x7d\x9a\x4c\xb5\x23\x6b\xcf\x65\x6c\xe3\x25\xd4\x67\x08\xf1\x62\x7b\x10\x8d\xeb\xd8\x24\xc9\xc5\x4f\x04\x75\xcb\xb5\xb3\xa4\xd3\x01\xb4\x78\x70\x82\xad\x52\x72\x59\x95\x30\x47\x0c\x0b\xf7\xf4\xde\x3c\xcc\x82\xf7\x9f\x6d\x6b\xe8\x6c\x07\xaf\x0c\xe5\xd3\x09\xb5\xc5\x4f\xd6\xee\x0e\x51\x31\xa5\xbe\x3c\x52\x45\x31\x97\xa0\xc2\x0e\xce\xf5\x7b\xaa\x21\xbb\xf9\x2c\x2b\x37\x1b\x32\x91\xad\xe8\xd0\xe3\xbb\xe2\x2b\xb9\x37\xc3\xa8\xec\x6a\xa7\x13\xbe\xd5\x62\xa8\x32\x78\xd0\x82\x08\x2c\xe4\xf7\xbf\x92\x87\x2a\x05\xa6\x05\x4b\x44\x24\xea\xcf\xf2\x4b\x49\x54\x2d\x20\xda\x4d\x28\xe0\x9c\x26\x1a\xcd\x26\x97\xf3\x9f\x9e\xe6\xdc\xf1\xd5\x6e\x64\xb6\x6f\x57\xff\x10\xc3\x30\x73\xb7\x91\x77\x46\x22\x5b\x6d\x6d\xd1\xef\x0f\xd3\xee\x73\x71\x99\x2a\xbf\x77\x92\x78\xf2\xb0\x31\xb5\x53\x01\x43\xe5\xcd\x8e\x88\x3e\x8d\x46\xa3\x8d\x82\x1d\x93\x4f\x49\x4e\xac\x1f\xde\xb3\xec\x45\x79\x8e\x7c\xb6\x40\x8c\x42\x7b\xee\xc7\x27\x62\x34\xbb\x54\xd9\x8e\x67\xeb\x16\x62\x4a\xa7\x16\xfd\xe8\x6e\x2a\x0c\x93\x4d\x17\xe0\x45\x8e\x5f\x5f\x34\x5d\x72\x28\x24\xc8\x7d\x9c\x68\x42\x50\x40\x62\x5b\x8c\x2c\xd6\x17\x2a\x34\x75\xd6\x92\xe6\xfe\xa7\x81\xc8\x38\x94\x36\xee\x30\x14\x29\x7c\x21\x45\x8d\xcb\x3f\x94\xee\x60\x67\x26\xcb\xa1\x57\x1d\xd3\xe5\x93\x15\xae\x7a\xf1\xe4\x79\x93\x01\x58\x90\xcd\x42\xb7\xf4\x3c\xf3\x09\x57\x3b\xda\x7a\xe7\xb8\xae\x87\x34\xc7\xf2\xe8\xb6\x4f\xf7\x5d\x43\xdd\x7f\xd2\x11\x29\x5c\xf0\xdd\x0f\xe0\xef\xad\x14\x46\x44\x4f\xb8\x67\x28\xa2\xb1\x79\x5c\xd4\xa0\x76\x21\x67\x8a\x91\x7c\x69\xf1\x22\x22\x8e\x14\xa1\x41\x2c\x54\x1f\x39\x65\x11\xcd\x60\xff\x8a\x44\x7d\xc9\x03\x01\xab\xe2\x1c\xed\x9e\x2f\xec\xe0\xee\x92\xdb\x38\xb8\x9d\xbb\x5f\x35\x84\x95\x06\xe6\x2e\x2a\x99\x52\xcf\x72\xdb\xf8\x88\x1f\xd8\x1f\x41\x63\xa7\xb7\x65\x3d\x87\x57\x72\x21\x77\xcd\x7e\xc8\x05\xf5\xeb\xc8\xb7\x1b\x20\x27\x50\x67\xd8\xed\x07\x00\x87\xa9\x52\x47\x92\x57\x54\x9f\x29\x84\x69\xe2\xc9\x91\xf1\x78\xe7\xc8\xd3\xaa\x17\x75\xed\xde\x1f\xc8\x98\xba\xf8\x8b\x53\x01\x47\x49\x67\xde\xbf\xb8\xd6\xa9\xe9\x1e\xd3\x05\xa7\xfa\xa8\x79\x4a\xb7\x68\x53\xb2\x60\x05\xbe\x79\xf6\x44\xd7\x93\xbb\x8b\xa2\x1a\xcd\x46\x23\xdb\xa2\xf7\xbd\x48\x52\x1f\x35\xd2\x23\x8f\x05\x0b\x94\xc6\x27\xab\xee\x38\x33\x9f\x9a\xa5\x6f\x65\x58\xba\xa2\xe6\x06\x0f\xb1\x6f\x39\xdf\x96\x4f\x4d\x30\xe0\x78\x5f\x9c\x87\x88\x11\xe0\x43\x73\x1d\x71\xb7\xcc\x0d\xf9\x47\x62\xb8\xb5\x94\x27\x08\x77\x8f\xe4\x03\xb5\xb2\x0d\xd8\x13\x10\x69\x34\x4f\xc8\x87\x7b\x87\xec\x41\x7c\x06\x62\xd2\xf7\xc0\x0f\x65\x44\x28\xd0\xfb\x93\x16\xb4\x35\x71\x9d\xa2\xba\x27\x91\x5f\xd7\x59\x1b\xd0\x46\xf2\x7e\x04\x81\x8a\x56\x71\xc8\x74\x68\xe9\x2b\x3f\x2a\x40\xde\x12\xe4\x62\x06\x81\xe2\xd3\x00\xa0\xea\xed\xcb\xd9\x82\xd8\xc3\x38\xac\x27\x29\xc8\x62\xad\xaf\xb6\x4d\xd9\x01\xae\x26\xc3\x36\x41\xad\x2d\x6f\xd4\x3b\xc8\x70\x1f\x32\x38\x87\xa4\xea\x48\x66\xf3\x1e\x22\xaf\x93\xb5\x34\x3b\xaa\x41\xbc\x44\x84\x2c\xd4\xf2\xa0\x7c\x60\xad\x64\xe1\x6f\xb3\xfe\xc4\xd3\x4e\x5f\x73\x7d\xc9\x72\x9d\xfc\x00\x60\xec\xe0\x79\xd0\x04\x1a\x51\xaa\x40\xc1\x90\x8e\xbe\xc2\x65\x25\x57\xd4\x46\x2f\xfa\x6f\xc9\xa5\xa7\x33\x1a\xe7\x17\x79\xcf\x18\x2e\x13\x19\x95\x07\x6a\x45\x51\xa6\x9c\xf9\x61\xa0\x63\xc3\x37\x6e\x5f\x97\xcb\xea\xa9\x4b\xac\xab\x17\xcb\x6f\xfc\xb8\xc7\xb3\x8c\x2b\x09\xef\x57\xac\x03\x6c\x8f\xd4\x9f\x65\x34\x5f\xcd\x6f\x7d\x37\x1e\x66\x01\xda\x22\x89\x55\x4e\xf2\xc9\xf2\x44\x4b\x23\x3e\x7c\x3d\xc8\x32\x5f\xec\xee\x17\x1a\xfa\xe6\x97\x82\x0e\xfe\x35\x4c\x3c\xc8\x21\x1e\xa0\x4b\x26\xdd\x5a\x39\xce\x6a\xbc\x7e\x9f\xd5\x03\xfb\x6f\x98\x97\xce\x8b\xec\x60\x93\x33\x27\x19\xbf\xba\xfb\x3f\xb8\x04\x92\xec\x5e\xec\x82\x00\x7e\x1e\xe6\xae\xac\x51\x5e\x55\x72\x85\x04\xdd\xeb\x1c\xe5\x64\x38\xc4\x24\x51\xaf\xbe\x47\x16\xfc\xc2\x97\x84\x11\x24\x5b\x2f\xaf\xe6\x89\x32\xe7\xa4\xda\x1f\x24\x8b\x6f\xc6\xc2\x5d\xa1\x96\x4f\x04\xb8\xb2\x97\x17\xf9\x2e\x4f\x71\x6d\xd9\x0c\x3c\xe5\x7f\xd0\x62\x91\x35\x84\xc9\x07\xa3\xfc\xfc\x46\x2c\x4a\x02\x6a\x4c\xe0\xf3\x32\xe7\xf7\x0a\x1a\x4d\x87\xfe\xc9\xd9\x89\x74\xf7\x47\xe3\x93\x6b\x7b\xfe\x3a\xd4\x50\x3a\x3d\x9f\x32\x1c\x1d\x2e\x73\x62\x4e\x49\x55\xe3\x8a\x2f\xe9\x1e\x3b\x6f\xb2\x15\x40\x1d\xe9\x29\x7c\x16\x7c\x49\x5e\x18\xa2\xbd\x11\x3a\xc4\x17\xa2\xc4\xe7\x8b\x60\x5a\x0e\x52\x1a\xc4\x49\xf9\x83\x41\x6e\x22\x3f\xf8\x9a\x38\x64\xe4\xcc\x9b\xf9\x67\xf1\x3b\x63\x4f\x2e\xe5\x1e\x77\xb9\x78\xa2\x7e\x4f\x31\x47\x79\xe4\x92\x71\x41\xcd\x3d\x60\x02\x85\x3d\x63\xd1\xd5\xb5\x51\xbe\xaa\xf8\x38\xdc\xda\xe5\x29\x3d\x58\x0d\xd1\xa2\x61\x83\x89\xfd\x24\x56\x1b\x39\xc2\x01\x47\xaf\x34\x66\x57\x4d\x8d\x85\x7a\x90\x4b\x2f\xaf\xd5\x92\x1c\xcc\x7e\xdf\xc4\x7f\xc1\x9b\x4f\x90\xf1\x08\x66\x5c\xec\x85\x48\xbd\x17\xcd\x5a\x24\x80\xe7\x57\x29\x4b\x74\x52\xce\xc5\x31\xd0\xf3\x22\xfe\x75\x5c\x5e\x55\xd7\xed\x11\xd8\xae\x52\x53\x66\x58\xe1\x2a\x24\xf8\x51\x48\x9d\x6e\x24\x94\x6b\xaa\x80\xd6\x0d\xe2\x3a\x12\x83\xa2\x53\x74\x2b\x64\x27\x2b\x53\xbf\x1d\x50\x3d\x51\xf0\x99\x9a\xc4\xbd\xd2\x38\x40\xa6\x38\x30\xcb\xd5\x03\x99\xa0\x89\x6d\x52\x70\x5c\x5a\xb0\x66\xce\x0c\xa9\xfb\xd7\xf0\x86\xc6\x46\xb7\xcc\x72\x3d\xcc\xaf\xdd\x3c\x2f\xc6\x77\x6b\x3e\xfc\x1d\xb7\x6d\x9b\x75\x0c\xea\x6f\x1b\x96\xf3\xfd\x36\x46\x77\x09\x10\xef\xf3\x8d\x54\x51\x92\x33\x67\xc4\x02\xf5\x40\xed\xfd\x36\x97\x15\x5b\xec\xb8\xfc\x29\x4b\x02\x78\x85\x60\x29\x12\x0e\xe8\x43\x2b\x23\xca\x5c\x3f\xb0\x03\x3d\x56\xba\x1d\x34\x7c\xbd\x11\x55\x06\xfa\xd5\xc5\x80\x28\x2b\x92\x66\x28\x36\xba\xc6\x3b\x99\x4e\x82\xd2\xfe\x44\x6e\x35\x8a\x3d\xf9\xd1\xd1\x8f\x13\x08\xc1\xfb\xd8\xc3\x32\x9b\xc6\x95\xdd\xef\x5d\xd2\x0d\xc4\x7a\xf7\x1b\xf2\x69\x7d\x04\x69\x8f\x04\x83\x79\xd9\x15\x19\x3c\xae\x0c\xdd\xc4\x0d\x81\xed\xef\xfa\x43\x67\xff\xc8\xa9\x5f\xfb\xa5\xb3\xa0\x64\x03\xe0\x71\x99\x69\xab\x6d\x46\x65\xc2\xc2\x58\x43\xc7\x9c\x4a\x3a\x8a\x1a\x1a\xcb\x6b\x34\x16\x4f\xdb\xc4\x5f\xc4\x2f\x5e\x06\x03\xaf\xd2\xe8\x2b\x56\x23\x8d\xd3\xf6\xb5\x71\x00\x8e\x15\x8d\xbb\xd3\xbe\x90\x5c\xee\x9b\xa7\xfc\x4d\xa0\x0d\x71\xb0\x16\xfa\x03\x36\x14\x4e\xd2\x4e\xfb\xed\xd2\x60\x6d\xaf\xb0\x7a\x2c\xf3\x3f\x87\xf4\xf7\xc6\xaa\x6b\xcf\x95\xca\x47\x8d\x4d\x9c\xd6\xc4\x1c\x62\x18\x77\x1a\x38\xd4\x37\x95\x45\xcd\xeb\x08\xc3\xd7\x29\x31\x25\xc0\x74\xaf\x2b\x43\x4c\x50\xf9\x4b\x75\x2e\x52\xa8\xbf\x2f\xa3\xc2\xc2\x61\xc7\x11\x7a\xc4\x32\x04\xcf\x47\x07\xe8\xa2\x63\x04\xec\x97\x46\xc1\xd0\x64\x42\xe6\x52\x22\x44\x14\xe1\x79\xda\x23\xe0\xbe\x35\x54\x2c\x95\x6a\x4c\x0d\x07\xb4\x42\xbc\x80\xa1\x11\xde\xbd\x23\x17\x17\x06\xf0\xd0\x63\x17\xe5\x9f\x19\x8f\x32\xf1\x32\x8f\x8a\x13\xe3\xf5\xa0\x26\x2d\x79\x2a\x57\x02\x85\x20\x63\x21\xa7\xd1\x8e\x41\x95\xeb\x99\x3a\x85\x8a\x4e\x2a\x4f\xbf\x9b\xe1\x85\xda\xa5\x2e\x1c\x4f\x15\x37\xae\xdf\x7f\x8f\x5b\x6a\x1a\xd6\xf3\xb1\xfc\x34\x14\xa5\x26\x3a\xad\x45\xca\x94\x62\xdf\x04\xc2\xab\x6e\x9b\xe6\x36\x37\xdc\x17\x11\x69\x88\x75\xe8\x59\x70\x63\x7b\x8c\x60\x01\x79\x72\x20\xa0\x4b\x53\x49\xf9\x71\xe5\x5f\x7a\x90\xa6\x1d\xb8\xab\x23\xf7\xac\x53\x35\x3a\x00\x31\x0e\x40\x14\x91\x96\x11\xbf\x93\x5d\x59\x7c\x73\xe4\xcc\xa3\xa9\x4e\x07\x27\xca\xa1\xc2\x14\x9f\x1b\xbe\x06\x72\x5f\x34\x04\x7e\x1f\x45\x74\x1a\x02\x94\xde\xf7\x73\x61\x3a\x59\x22\x67\x8e\xe5\xd5\x91\xcd\x03\x22\xd6\x52\xc8\x3c\xdc\xf5\x26\x12\xd0\x32\x3c\x33\xe7\xdb\x3e\x8d\xb6\x06\x1b\x24\x22\xec\x2a\xcb\xa8\x07\x39\x31\xfa\x55\x20\x43\x5d\x30\x4f\x14\xc9\x8f\x29\x31\xcf\x47\x90\xd8\xe2\x90\x5b\x58\x1a\x04\xfa\xd0\xf5\xb5\xa4\x9a\xc5\x44\x9f\xad\x65\xbc\x09\xfd\xcb\xb6\xc1\xb8\xe9\x90\xba\x40\xc7\x46\x1a\x56\x2e\x4c\x65\x11\xb9\x91\xab\x08\xff\x3e\x1a\xc3\x5a\xc2\x91\xc0\x2a\xee\x09\xc5\x81\x26\x30\xc6\xe4\x5a\x62\x33\xb3\xd8\xd4\x22\x98\xaf\x51\x7c\xc4\x75\x88\x7a\xf0\xb1\x19\xd4\x72\x10\x94\x16\x41\x51\xa9\xab\x9e\x45\xbe\x59\x65\xb8\xf0\x60\xec\xe9\xae\x61\xde\xbb\x29\x35\x3c\xb4\x01\xa4\x30\xe5\x7f\x7b\xe0\x67\xcc\x06\x8c\xd9\x77\xed\x2e\x71\x79\x7b\x1e\x51\x47\x26\x71\xa9\x3d\xcc\xa3\x36\x3c\xf2\xb9\x74\x39\xbb\x91\x4a\x8f\x96\x83\xee\xd7\x63\x8f\xac\x25\x39\x7e\x6f\xab";

const int MAX_N = 128;
int a[MAX_N][MAX_N + 1];

void exchange(int *x, int *y) {
    int t = *x;
    *x = *y;
    *y = t;
}

void exchange_row(int x, int y) {
    for (int i = 0; i <= MAX_N; ++i) {
        exchange(&a[x][i], &a[y][i]);
    }
}

void gaussian() {
    for (int i = 0; i < MAX_N; ++i) {
        if (!a[i][i]) {
            for (int j = i + 1; j < MAX_N; ++j) {
                if (a[j][i]) {
                    exchange_row(i, j);
                    break;
                }
            }
        }
        for (int j = i + 1; j < MAX_N; ++j) {
            if (!a[j][i]) {
                continue;
            }
            for (int k = i; k <= MAX_N; ++k) {
                a[j][k] ^= a[i][k];
            }
        }
    }
    for (int i = MAX_N - 1; i > 0; --i) {
        if (!a[i][i]) {
            continue;
        }
        for (int j = i - 1; j >= 0; --j) {
            if (a[j][i]) {
                a[j][i] ^= a[i][i];
                a[j][MAX_N] ^= a[i][MAX_N];
            }
        }
    }
}

void zapus_get(char s[]) {
    char *aim = s - 0x10;
    // aim = "\xAD\xEF\x43\xFD\xFE\x77\xBC\x1C\xFE\xE8\xF2\x19\x5A\x73\x83\xDA";
    // aim = "\xF9\x89\x6E\x83\x19\x0F\xBF\x21\x24\x8C\x0D\x09\xA1\xFB\xA8\xFE";
    // aim = "\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00";

    for (int i = 0; i < 0x10; ++i) {
        for (int j = 0; j < 8; ++j) {
            a[i * 8 + j][MAX_N] = (aim[i] >> (7 - j)) & 1;
        }
    }
    for (int i = 0; i < 0x80; ++i) {
        for (int j = 0; j < 0x10; ++j) {
            for (int k = 0; k < 8; ++k) {
                a[i][j * 8 + k] = (ida_chars[i * 0x10 + j] >> k) & 1;
            }
        }
    }
    gaussian();
    for (int i = 0; i < MAX_N; ++i) {
        for (int j = 0; j <= MAX_N; ++j) {
            printf("%d", a[i][j]);
        }
        printf("\n");
    }
    for (int i = 0; i < 0x10; ++i) {
        s[i] = 0;
        for (int j = 0; j < 8; ++j) {
            s[i] = s[i] << 1 | a[i * 8 + j][MAX_N];
        }
        printf("%#x\n", s[i]);
    }
    // printf("crc: %#x\n", (*(int *)aim));
    // doit(*(int *)aim);
    // doit(3069720756UL);
    // memcpy(s, "0123456789abcdef", 16);
}

