# only low 32bits randomized
# reference: http://mslc.ctf.su/wp/plaidctf-2016-sexec-crypto-300/
# lol can be solved the same way

Q = 2**64
S = Zmod(Q)

def Babai_closest_vector(M, G, target):
    small = target
    for _ in xrange(1):
        for i in reversed(range(M.nrows())):
            c = ((small * G[i]) / (G[i] * G[i])).round()
            small -=  M[i] * c
    return target - small
 
# eatracted using gdb
a = [[2947667278772165694, 18301848765998365067L, 729919693006235833, 11021831128136023278L, 10003392056472839596L, 1054412044467431918, 11649642299870863663L, 7813497161378842344, 15536964167022953318L, 16718309832681015833L, 7805705913528825107, 12092317580524320504L, 17163424360305231502L, 6352792256529822470, 4696818759170745400, 8202730408965517889, 14576421520683731187L, 12828242264541034313L, 10287390044869019765L, 5302155820127968924, 2689827791448149775, 10685535775509358833L, 10414102509512663394L, 2700937582377962954, 2770061463645390892, 367716015581738287, 10227015405405607450L, 12679040793862387242L, 7160159996042967007, 17133129490705945961L], [3316611681754028984, 3503182316394155159, 8783759536627765131, 4742464775291708339, 18085324282144867335L, 18178722390696919119L, 2943048739896431039, 12360523784589775266L, 14162880691931926817L, 15461746323169033968L, 3183124918742401951, 2398631656440096777, 5842632196960363216, 16285910685765821465L, 7375078072468444798, 7708428399011769513, 9517411431608960515L, 9131959130339861073, 2129461186021157660, 13980328397181907123L, 2654403080104352464, 3948910203829515833, 3600951923571138577, 10992740504423930796L, 15549967251151492945L, 15936049494539447899L, 9767708997756962562L, 9966447198585977888L, 9833313963867008900L, 2140032717197149199], [17529482070312284089L, 14712313724280757413L, 5134567830016493736, 10203020374726213855L, 5560736588152128922, 50526560201835791, 1288735234894005209, 3656101241126025060, 872395409727236160, 7628415731883617240, 16460662479705860077L, 7532118334194327900, 14259850975740622310L, 12786739352107754610L, 1385650499154098855, 104036638109879987, 5064642659386546341, 12424757931130901416L, 16664810480572815579L, 6095105489315893325, 4180544558831644715, 14819840962342803520L, 11085652895711222850L, 13798419959623274634L, 12271945953752839401L, 2850539405261150594, 11160049987125656884L, 8958559502747177919, 904423177228953585, 12630205232161749414L], [13141598847402266467L, 13606921296038063721L, 10408823669199584661L, 6180790126625913638, 18391730333314207004L, 15490857873343718217L, 15702317211326774841L, 12213922876777583612L, 14488557467937435359L, 14849358538316391691L, 7471967891507707693, 14783317997943228567L, 11547495498871255943L, 1782369278254139532, 15333512284957996989L, 10516136935370336099L, 11063259527510757444L, 8368941907803038108, 13667943983821274564L, 6907470580131082024, 1874822859525606040, 10887786280343242777L, 17890757194059532882L, 1901922403937102922, 5091399942709583837, 11905846406990743115L, 8201289666717104552, 10605629648576961640L, 12670683512626218712L, 13235088122562438619L], [17715398325448490522L, 14301139601004566963L, 9349651502813856767L, 17563331973205997389L, 1905210026244353218, 15257802461379463628L, 8986706047402457875, 5065362127185335458, 11508726936772866016L, 6294625250651699606, 14499705312072676611L, 1295525332750178216, 9220705861301793541, 1043866678491312969, 7458159289518051366, 12335024212078259866L, 11000272774254619662L, 8987869970972069470, 5645843727051793963, 12673298200378004234L, 670360229562746506, 10338790907403564116L, 15872762685488040350L, 1938432293053293888, 6979534609612400792, 7740163366736279440, 17831390317946573280L, 8312770459222719741, 7260741108538099778, 8376642175644027621], [11507688926588332287L, 15322238358174805798L, 4703532604898137224, 69327086418679028, 8347057230978218896, 10994878445802041726L, 18081729901143002129L, 2316049702218351750, 6108098321766754233, 1977965763366222073, 9066156543284058815, 6068676971917232120, 3397848752343889772, 11964389343672465482L, 6106632033451200995, 12945857486872575299L, 3654318134410001861, 18139686677150413169L, 1740950411265518340, 6159766462282936355, 17523003190336216332L, 2323294518400154016, 9005470264420031812, 13863806524330920177L, 10581805022198343408L, 8195191286347319406, 170640746282551923, 11995448146469348381L, 13491801380921470058L, 18316071398096262073L], [10858600900589482543L, 17397982235049203431L, 10000388517938697705L, 6108073353944890609, 16803183835234961672L, 5167226607322171931, 11939414622817429900L, 13653798697299199571L, 3333945340172158665, 12548555544398068529L, 15012228962440633530L, 2724216883147419539, 11429095182023424544L, 4093660810259312194, 1422800669519162670, 12846061489278171396L, 12662123003639905077L, 9270337255731656390L, 14315304173385908360L, 10189456186385756442L, 8509628177018496240, 15175688804482391066L, 3792056363381961002, 8190605111500712435, 10611199511500470235L, 11230925503658179323L, 8371331260984505690, 16750273867682411291L, 7465126863994833527, 13615713886700226307L], [17314225379876547704L, 4964422599206114012, 4203176027904497057, 4800945702359627477, 15541107151149506575L, 14958149546182485879L, 16757948893058618529L, 17628631533153395616L, 12645651149068054038L, 6576530574938028813, 12270721055708149187L, 17047606259712833932L, 175919904470565066, 632412468838029782, 17060462294787179125L, 12976664388660647054L, 10993621520088076725L, 8595822224422846979, 10274251075592280893L, 16559720899596051034L, 18392697621241326548L, 8357193473079483032, 14427832695366809619L, 17095585829464605313L, 14595223350744966115L, 16933967695167075096L, 12176563748114520059L, 10215894611153909341L, 2622624501731644949, 13826212398207872736L], [14561712329475232514L, 8786811233083472507, 5916462519076812425, 8798064097695441834, 5197929407520104631, 16641403932784140238L, 11098701291107759373L, 6275107265622727975, 7375216066112433297, 14482348410024327712L, 16829169890009375699L, 8419030269177913208, 9292386962612851005L, 16001001073016046157L, 7218746086436864611, 5420390819180355256, 3741613316259423393, 8847224405990900354, 8659527105113215679, 9342877740437440756L, 771601200500639209, 18385338586328463485L, 11750580443246301620L, 12856791217667700922L, 11109088957288639488L, 12254808718310863023L, 8625143621149437156, 5869223061867387038, 12284035413417220106L, 2066552779344276928], [15241142888642317391L, 2246378976408795298, 12980010063249501325L, 10902579424406327458L, 960536931504095176, 5836556283531592946, 2257049437822577910, 5851757486069456055, 6706671087685486731, 5466879658003347937, 11223948574174964658L, 18373413623414560909L, 16575998662071098558L, 13792193660801219106L, 8287071478912901233, 16636184556552810202L, 9467841988697328012L, 3855567514907379371, 16335289042584176009L, 15693985703932256879L, 463131106948498838, 13613246065343087125L, 9217725463067791441, 1728034172506957660, 16615973495481645816L, 15581423893974288374L, 11778851455330623969L, 17642539084238473368L, 4492846896356329178, 7970737630735691025], [12826371775943815619L, 12414349294720483161L, 10732608448865696546L, 6861527292340751763, 5347471402392899707, 920743493258113171, 11553039367027754880L, 10561891713153866894L, 5900917760593730717, 15275503859816047241L, 14165040369326021580L, 11228354904504431959L, 17661967264253682746L, 18066610840454826573L, 4364364232226215676, 3403289657916824251, 15091133621179674343L, 10076799167764222411L, 10125404660451466940L, 12547543766425098633L, 6269565913506381840, 13723957091825187625L, 15396916752025060567L, 17893676816496762899L, 9112149662508439494, 17484687967322935366L, 17831843237592159787L, 18186878822358284020L, 7653972510060205781, 3341463813453603479], [13190222849216386065L, 14339268752368464656L, 8265575445301309076, 9402843364825452654L, 14225875103247341721L, 9234998464892287325L, 11250274544437577314L, 11134674761133087469L, 14232716556170321521L, 7877941103119245198, 14533148119936226315L, 9014144700766467172, 10799165808545156, 1416839786127157397, 12021166300826462008L, 3077504070949813510, 1435154157379353879, 7151111928444950164, 4465385424784256933, 14769946265476776605L, 1354383178807622516, 4745028298636572543, 4764874768793158851, 13510090595471001433L, 11359652867655860877L, 9139207191730259024, 17799545621939802603L, 15755992191636602328L, 11303924442142839169L, 13241369834287911618L], [10019825376145767968L, 7411261558319090215, 18346193254711804793L, 2821621893373097581, 9402451495360028088L, 10483720184442032324L, 7614784519802766716, 15401798928526992602L, 2432068888932105917, 13219874403024824834L, 16326003631907508256L, 11350970362715470190L, 11037810585057994148L, 9116833985000292077, 11041354571540774291L, 5188424889976740799, 7950274941336314512, 5244434357635952983, 15215559777148042991L, 18073283660499106083L, 6398255650250321808, 773127436392226967, 9317529446933373700L, 7323471584164970725, 12564817781723609611L, 524212149895949911, 13107315731287225924L, 15601409428869338676L, 8624202819532372157, 2575254685428606308], [6847495108866974221, 1421989537183491683, 8586697343370377734, 18059684026619556092L, 6224860385266382394, 4049481232526440184, 1638037053468440434, 10169743994758543632L, 7738194303643747956, 17638030977007642255L, 12416107771032822430L, 2668231426739320709, 2631885819433818624, 4489964053914554758, 7794466275370733733, 18110900614141824601L, 14972847359508178108L, 2291379353457802485, 6720858321373092513, 13938358475659001297L, 120146148403778663, 10270570898411336786L, 7804346516531870512, 8236838951981207785, 17189658861080736330L, 4289663811735037967, 18302476558474272350L, 13358676543648089374L, 15973476360271379983L, 11610261880274371243L], [2401839894794299239, 3140563596480516526, 477849260459547583, 8762666758548083186, 15277882008551411052L, 7840383475286160036, 6243746019302172066, 4764240900879844425, 12353887271846654778L, 7045806113307277110, 13101271057076113716L, 12559214744942671713L, 11535916603527696504L, 2476222418083703167, 2517794187511477348, 1822761302026470216, 9838842270502418140L, 5528382485368174664, 11669674205621108174L, 4388296175963492265, 4309898221713291729, 14712107645505109898L, 14636300148985065620L, 14452475286390444580L, 4664858427331436864, 12251402214994792989L, 18067468892943722802L, 8444055086524035370, 2619652156901001256, 3316316435548446267], [1748022811987036342, 3494948531388160811, 707084804831206247, 15751092609486762933L, 10733272449966037946L, 12544870827393000852L, 3538784233831066450, 15145064915118004734L, 3525853467918000100, 7169439053758253553, 13641039225504399108L, 8261512971562855351, 7773202064243379569, 15613281884749276439L, 2613833440355434246, 3582476386351707134, 16936529210318259770L, 7563074798427102612, 6865221602724658541, 11979901518557085324L, 7335813984501922442, 13675406127967096890L, 4694419907252622582, 7267247875220859955, 13642701596462045793L, 1464901799589545587, 9444041614800373751L, 16863841177146890462L, 15296696274887616449L, 477532290628779753], [7357736696370254311, 11922058623846706675L, 11149478124296058568L, 15134665718337446192L, 871409380087976822, 4173029592060424278, 8361348035153927022, 3594137075397809950, 14452575140899440479L, 7620980046691479079, 10580426235286917882L, 16481199743535266292L, 15476500196343788130L, 13074435894637096529L, 14562179088568043217L, 2568396834791957612, 5500212696472122139, 6607300364443373576, 12684095350357128710L, 5902966771193576748, 17896818397170865571L, 5999207766262807030, 10385650150875799603L, 4299181844105385833, 8668007195083754256, 2062454615482608086, 976909823853047463, 4079023243271752806, 1594975762183924235, 15730171223631058769L], [11877218361644491616L, 15391041324465974041L, 4234964801256893051, 4577570485573586799, 8191301589003135276, 8068299453651594774, 5852178751023674337, 13832862600605363478L, 7970088265179676333, 14582942952639200251L, 16331556144677973625L, 6783688792201211800, 15457352654905208821L, 6951546306426157200, 1666190583573137949, 12579875933164372197L, 1276451045167491551, 5080710665732226541, 216592888475613631, 13469333435764528215L, 15645475214286262661L, 3813234198090448970, 1692174731332797907, 5433382652487299835, 10746519008100351578L, 15325348027537564305L, 3340582671127282329, 7739800828305899067, 10656187057171709867L, 5863394871374356191], [17090642413213226783L, 7900624047245537056, 14547532310382279418L, 2725984978213013993, 6615500742506183051, 1156682975244549468, 522216257022393548, 10058286173356251421L, 7660820267688330178, 17482214785708469513L, 9210823971029066047, 6482772326059604350, 15864257499168492013L, 2233311891763432954, 6591720651534851312, 2244055590013778157, 18012841891944692076L, 2785256252327715664, 14647293983276752297L, 1679279985562228718, 15753772463061531395L, 3344691005356952730, 4954685961773130839, 14556028066075138457L, 12001362356313338752L, 12224948681331785617L, 4922999409386122726, 66015964892190577, 4553351581838103333, 8854666248671853689], [13008676370311579129L, 2166684347837839133, 8522009610838818384, 8474203628386234122, 1716939253721243400, 17204280904167066404L, 5279371116935161492, 8405135241243104447, 14515476353482445702L, 16425113441697357275L, 11734801101748993591L, 9525328670441219608L, 10390541308656493267L, 18186639328328585153L, 3670632011583346174, 10020476884965074859L, 12833350163468047109L, 12888600408396835780L, 5544382356065238395, 14762865448278275297L, 15815569612585384315L, 15546619939775826200L, 10085980070543440982L, 741104820587202822, 9529376859060703081L, 14545437084266172475L, 1695543471347710990, 10373109241463206807L, 12832277771801603472L, 1829841359218213679], [17727682649225585388L, 11770114274346393189L, 11559811457484104304L, 17769935405020944191L, 15808501841956243654L, 3022060199709962551, 16638743728974824209L, 10103997850219159106L, 12564948280987619807L, 4188736124951017430, 17402944565256589345L, 18337541579689522102L, 9791245073159972134L, 5348797483146128922, 15791305624879760694L, 10721952873004116737L, 5967893478914275428, 590683638072828654, 8604424119423767394, 12372131206725867400L, 9632282989604199944L, 8005303147364558096, 9393704578415797992L, 12220678344985132467L, 13999015252384676179L, 7037817909712161148, 1076823952396213433, 7730342950058231495, 7912289132170809326, 16693361865488884741L], [4217673548859325435, 11408811940256259149L, 3816351419102298425, 15015017889894267622L, 10067839039781967735L, 12920890894944166987L, 16887991214644431627L, 7087287643320436013, 8260588386274561217, 15712625626438262460L, 725793539004236714, 12006099458868519083L, 12984248901963102962L, 9884082917200679401L, 11144636777797292083L, 15333555936573944500L, 4905701109154516901, 14106733654863075488L, 17429062237346122846L, 5706528589784441731, 9031178098206999310, 11422688444902609710L, 14539273996582383829L, 17069750609662566770L, 13632187384415684801L, 4503014697958126640, 9258317559324283222L, 9359732713392192930L, 3126580241469503259, 7608621851191419664], [13868608975203576356L, 16873492060192732037L, 12312954278457354880L, 2319967541960613447, 18126258356189265052L, 16049327109071926260L, 13873346382411947457L, 13365885725661094970L, 17963336497030111418L, 12839973689998114417L, 18163682489647945256L, 7432813216123442690, 14478716708992929778L, 8508765114530984146, 16757332812395423284L, 10140169705092019160L, 17260266034345764139L, 15138435058236525175L, 13542455277458293553L, 17204934784300929959L, 12610524423376971554L, 1938608342752405581, 4793738780970253040, 294367776542117129, 18035262553740665180L, 15819165635981883911L, 8172636145707671172, 7467712246361146263, 13982684616976250689L, 6563077897296468714], [15311690595076567553L, 9024976805640349698, 14204276916545231717L, 5175644332685249583, 3448171472920588143, 13100785051490339729L, 1172514477266189168, 14712539091810655004L, 13834075290725533892L, 7912536461361087978, 10825069619431918256L, 8532487415816240964, 7263298666553433775, 536198572552566033, 1108257564537263619, 11009379835678397957L, 14717763717407592936L, 15816327013490244812L, 9756702565580982634L, 10211893721314122901L, 7702048615852556018, 15130902357770700948L, 18065732735166192921L, 11913597240789613593L, 5362349703261726662, 5956023173201623431, 18013344999001211135L, 5880911319921882563, 10289741193622624279L, 13599936386506691245L], [14890121148518949036L, 14745586486403347838L, 1342292035594008429, 10757875130595396328L, 2965248868626294928, 12187709967341893197L, 11424666694597412151L, 4780423602906451992, 17026501639272802313L, 10620248639376708757L, 8891680256845492572, 3550237412966702320, 991212826804813443, 2053183481621316382, 17410716385134222514L, 11971055284904196998L, 1967636779034400764, 7310256516992547924, 6434382879815271501, 11716954616371867584L, 9766639160622356058L, 13395059341423661657L, 103163605043262092, 8344074274027845397, 17552506514388452147L, 8795793501993252875, 1257680752137576909, 10833037416073577349L, 2835382097419286486, 9067857086851164781], [9222076962802676259, 11198697393584866830L, 9038188985571967170, 2623678946789588413, 1044856026833351984, 14640054689034587739L, 9571972804021399562L, 14879749229638439733L, 24980805768334245, 8997813275799948634, 11451173806031955051L, 18329688352259312912L, 15062776052595981897L, 17201016365353410172L, 4163002929346802039, 4458080442040425751, 6203253341335502437, 4893667483881628859, 5355350628690347237, 14424169779359590442L, 764905730297804170, 2169941710592197312, 10472405591670166143L, 131110708335629163, 13905484722097837721L, 4070803766602329521, 14379895756476918417L, 15495225790659016030L, 16976043553623461198L, 9796669330399216964L], [14385768453913236057L, 3954862248954699265, 1266511780896778587, 18442252561436533575L, 3014395515272770529, 961457282766068590, 17041785901126292845L, 6508920933086537886, 17505190689178704312L, 2342652612566525391, 8075073492544339901, 7709986454281805617, 15877333939797633978L, 7793401605120678373, 12277882197576029398L, 18096916991958377889L, 7084106569692377073, 5347095141104068812, 6597856137523375220, 14276566857733034140L, 9623197647638450152L, 1890969699322541332, 7949284709555040056, 8317231989565703328, 4080269902074531007, 1242314589251626537, 6840974393263489464, 17125579808300295019L, 11452717842629299596L, 11856712932107743710L], [17946944691454527064L, 8642430889215669408, 2839711074885720592, 5892699277104397793, 6963394525690317689, 8914338166308780398, 11485669201901949098L, 13257358948698228782L, 13569521458913998699L, 1731652140775146389, 11061340946482831182L, 1203920707636103787, 13880805663137177948L, 3465776506692203662, 8128809075334169448, 927523008884576866, 1702672807631111151, 9279765431013271035L, 12313787296747132185L, 5939036006434699754, 5152318698036290462, 16055021672997498174L, 10299380375009387181L, 16341261226890446201L, 7296354343988592739, 15920380750106374453L, 14527519085871503959L, 7293510991877405699, 4353073920798699311, 16283526545798191053L], [6304122201947490961, 16014011578678628038L, 7920155629064823070, 3268691715567975538, 4746216663273403133, 3146711345806701454, 10891566811815806366L, 7264551756179773853, 1731084284225102280, 3120378634532413473, 8493457871017776124, 7462813881933385942, 9322835092889108562L, 13429960904895750702L, 2811706595932016104, 9732342633724006543L, 9947430385598379262L, 3309200802862964984, 10892598478876514581L, 6424023507855820983, 12049714640191087, 10812602368680281890L, 3685893270088727522, 17321606943424320310L, 6949426088118900343, 12505944601163855675L, 4488131224900635461, 8806434073094661939, 11184951242215082060L, 13633716133660764024L], [4639919094862718013, 8316326253706725895, 11725023268062885930L, 13862609247201443276L, 1433424571399793351, 4874179512764043622, 1045473419324254836, 6032577091712158396, 12601664581421386163L, 1593564460979454910, 8894800831095253685, 3689008460870754757, 9228261263686238809L, 12549094569713466181L, 16302154984300736839L, 16551959031967619024L, 17932195336985174109L, 3360652760836672201, 7105135879467372466, 11247694382379984815L, 62472516833442365, 3912172367479146561, 1388742533706681214, 17982169873983858676L, 4242021804479403126, 13355416156517901143L, 9475770866455834292L, 4588871566765774164, 6636653164166831975, 2683258515162617903], [692048859980755737, 491674207135753849, 7973157370008126356, 11610503576107945031L, 2835113887852910482, 9690515712704621514L, 9111116806655359811, 13804669009528714388L, 15603026086498780614L, 5898353949091270529, 14119282780744690754L, 742536116131496140, 17934210817631996009L, 18327415628522438844L, 5623573398972316999, 1391346228025399126, 14511785093189662503L, 10431188850198087512L, 14453254774849936988L, 7000058309991037046, 146974449375684011, 15245564083989500813L, 15240975067367343581L, 3897253345737266715, 3432415171248548007, 1686765217846425366, 15675429639675857117L, 3632173473050602534, 14957185372335986472L, 13369243150124249033L], [16637955504794897318L, 4561558838735726296, 8804333183716963786, 5772011959743717217, 16054502474431208605L, 6179576798513002509, 8807259459797039904, 6889723219405195320, 7517188911435274583, 3072553367497397453, 888831151715683906, 2813657161500872476, 619893515439623437, 12938684428553259525L, 5814615462150268042, 10781032400878104274L, 6934140660920820040, 6263504566006047458, 7402005958687555967, 17515804688039843357L, 8937185263576863883, 3977373194999253903, 10197887986484900258L, 9127950040062271545, 9117480526551874432, 8272802656386530280, 12443553894554769328L, 8437704457458214797, 9386328944030693658L, 11852255586416933113L], [11961857187638676362L, 12717572223999423240L, 5021695973761746810, 1451105810708399920, 8636610339687324154, 18154541957502645530L, 8892432240141368121, 14482365206443883349L, 13766588931610700625L, 365160859072800427, 13331653462578362316L, 8207093087151124322, 5888062840961114660, 14291759097357311582L, 1368654141726797089, 6282746104152325267, 6753328619213069131, 15496955381732076704L, 1322194569679146731, 16640372500914879599L, 8361343135850665983, 11482352575092117506L, 10301856890522891727L, 2791108357249876231, 8242187829930463033, 11056952996796139939L, 1020181559376263826, 2881938564990760096, 3915568338278950853, 14271138709857895741L], [6945595858053388608, 4207204007772020392, 14564262508755990780L, 16401432929737352510L, 1881820450581633227, 15293367414509766373L, 8471495498483429701, 11665683480083006762L, 16715320457080910775L, 13588344625309223635L, 15944741113897997362L, 12116977890031260836L, 4399441594124584146, 17305801470133753354L, 16962473019124511735L, 15763462422317714422L, 14226440057614561744L, 10575286240369779255L, 12990369002181834907L, 9413637186736612030L, 13816456419717922624L, 14442311974455709801L, 1339423746701674038, 11806617022206882272L, 15779296207796509332L, 5254423508155386392, 17938056411222660619L, 7384905422877530248, 1368702875998134124, 11957247176980587184L], [6877492173693929642, 4855635734527503612, 7727674801761096569, 6618853283049870550, 1979350961961663192, 8788534080618768039, 4028235539628700255, 6633766964931762412, 11676230871160800700L, 8122669077667096824, 15005114705220426369L, 16124079090209062940L, 7215923504640732414, 11869217684786476651L, 12125769365336711105L, 2980625151272255011, 7343915829233984514, 4914071910649049938, 8148312906591075935, 3363131166998952078, 14850408333627064336L, 11579377230718253948L, 17679718139766520181L, 7100383891584127328, 10114586318864402232L, 12422691424779643297L, 8822281732688803886, 16903899129023152811L, 10507996651337485647L, 11514419565644027666L], [9534037302361036687L, 11910963986700169917L, 2517616435913928482, 17746181735265249512L, 13373699992802266557L, 7861714134642990495, 13435712116268741856L, 17884803908983152135L, 16419923735942844903L, 13317377508994858135L, 15030358930162348845L, 11350443237257697593L, 107346340831742555, 7088566999265162187, 18074191048504654833L, 15448106462431984091L, 7997605200666854270, 16016424420392885897L, 16831834335738379783L, 15317073937563513379L, 11442372394661171632L, 7995938040530293359, 9369142896753998332L, 15791227245770244037L, 3198000119276883472, 16721951291424655872L, 9100351915090801041, 16608411603920185420L, 2143402224202261946, 17062041606329096065L], [528113605850962265, 5727297344146302689, 7355564764150119854, 7499011129406767416, 6526081998285417462, 18019440602930039742L, 16325135165138022838L, 7590605625512783977, 17005460940674822578L, 13464268537660580461L, 4880619940186606007, 5075603420912892219, 10031665071195547719L, 14428066649537610682L, 14840617178794312990L, 3734366596766256097, 1808840361457884052, 17992198732719594869L, 13487984701269662771L, 3911693780994306213, 7016602712681275696, 389692473476961906, 12316444162957265211L, 8728943427859295486, 11301976075043559017L, 9747628987386543323L, 2332859778536829539, 15490621379381024802L, 3897655750415967841, 627275222475474515], [15781009153755945473L, 12997661509078889895L, 8821732145191575943, 771662410571999022, 14506938614519485679L, 12681052806884428567L, 11239502348827916214L, 6578197862193331641, 15365108409774152453L, 5051118821463777591, 17486777844869602196L, 2746307714551166762, 14055764293339348259L, 3249125076019317874, 6993978920005913338, 6534278563958439195, 14835836620806449967L, 88194819432709049, 12999173795142565536L, 10750328031132829403L, 14046799170316531893L, 8396399330941727913, 16618027768720624411L, 5594998616524796598, 9821560826570667265L, 10311851290159293115L, 11551676854588553651L, 13631433459879947353L, 8549824078946017175, 2739607751040702857], [3737297308847952902, 5146637133348804630, 13164985861670220461L, 2935295169040361900, 1541897609395166331, 138308671845929214, 50348658889742802, 17336373983121645745L, 10538369723080862205L, 16709141593322564047L, 13668802843876304722L, 11078954634861697861L, 16842941467270568528L, 1375213520403950026, 13182422179063484454L, 3169985243804018517, 13482281283964203050L, 5025703429296706569, 16655110586626372433L, 4106609115179210001, 10677613955311884696L, 13177366808079067965L, 9082389975841438036, 115285338809914987, 4072612334095904025, 17831253868611680579L, 8053934136063112380, 1356615785592908321, 9213682551349890054, 13791267767953454770L], [3789733339177500102, 11670135255204989008L, 8757814655967080471, 12194830216674429990L, 2613572879335739556, 8439560122715184135, 15293437765244608429L, 8832809551501635521, 16443309208573271066L, 7590805416820498190, 1243739305853902622, 13115722814299398917L, 17460668484100883916L, 2164462293445846590, 9193813354308383296, 114099594052027774, 8151951116336401076, 15292717001945282688L, 8015425631457943024, 8913061113917229136, 13736025859283692011L, 13564240561938883341L, 6712247512356240804, 1238329206209586856, 17525140119222226557L, 3208337222513042635, 9009406378457669217, 4736276609786181569, 10448346537382731425L, 7106541375672680871], [2572466485605414131, 9115843818038766989, 1370937513867953572, 2812603469092490497, 17839110042941427166L, 16695546160446223528L, 18303379438121715999L, 16859019217579572832L, 6101376097002873501, 2970494964150054824, 3979067799918543783, 2940729831159657674, 17861111368979610195L, 9988446360612809500L, 4313279339770227953, 3264232457099253805, 14929963248393939142L, 492593995176986719, 18315450996253862404L, 3735978152775963630, 2216167550692365843, 8204853040229288990, 15732899245543977324L, 1222082383545443936, 4684190694729794161, 6122583213458269201, 10152376926223153343L, 13917482248312300828L, 10280437862318835186L, 17299583480078065658L], [13845487665445430790L, 9477939201467676819L, 12412851455953609926L, 14319415133577237831L, 9209510210826775368, 10501851836413528169L, 15833187116716877517L, 13463354172578679878L, 2267684059581486775, 6093972601451800571, 17944572641591773158L, 3217043118691967606, 9284709100275773296L, 2054652269807251095, 3448405993091827011, 12429084584338497631L, 7414304390774403463, 6337304555349855400, 14623545663073961950L, 10657668237938125235L, 16216678996498197307L, 14118343341490540741L, 9164946065180516832, 7405827930762115656, 7755630507098208665, 8087736323579051027, 3263694735928274460, 15358990971296681570L, 12254941041415390555L, 9548461725760741452L], [17911806608129356365L, 2750205378107734754, 18007781887712589042L, 3490317299649547077, 12661585704184860110L, 12726702851755267808L, 4101767383988094717, 16958324770161897262L, 7007614730055802608, 12005833284549548578L, 14251907296577057874L, 4409618334331497502, 4723857894008287569, 7719104662632145750, 16644141605086074975L, 13017504841784557591L, 5641294508904165565, 8925736610588761879, 16244379539466368457L, 10059813637544822348L, 8547319268544367235, 17909634642130522324L, 7356742162612760952, 14991824932293693317L, 13655134046440983885L, 2299786034438148913, 14814084540621682470L, 14448304003710707691L, 5807480573696519549, 7231633176655957661], [17167997874869424115L, 6087584155845739916, 7787643950499387713, 1469912222243660735, 3565878139456835646, 1790633503172072481, 7340351242711974144, 2468454302860640001, 10592340458018543835L, 14723264444341571466L, 17649747849752490150L, 404833266440380632, 13832696070971457365L, 4421813473057376391, 15855340955700757721L, 12638200785157627221L, 11258037650229132105L, 9435299754979776956L, 482274837872363973, 3034372046095477304, 8770066788702038798, 1223697732577476052, 4247679388182973692, 15565996671554644744L, 253358615303951930, 11196014403758142107L, 1859412181837104008, 4020514980430531288, 8803499345477179540, 14038810216395315983L], [483334415201458706, 12030961401776227140L, 15577134847917949632L, 1808916282834840254, 17899923372617643241L, 14315436961703502063L, 12477932215547760433L, 310477241588002078, 3279095634137406302, 1972167806654867546, 15336289017684122501L, 4562954266377395297, 13951078893850694924L, 11319248831538577359L, 7388605377328342881, 15478619400033922598L, 8673893466452433954, 28467713759545134, 5517256253473815457, 9082731034958399557, 2773374557461808077, 17661182818133523942L, 2199497341153500208, 10629542041922302180L, 974268065015345172, 16774322726937715771L, 5429616160443199046, 8639505635277903196, 4932595105243985911, 7201277756861211921], [13760673439842269818L, 16005852830491008910L, 4448698146090233519, 7346237289561995175, 4676599573419134494, 4791336440731675818, 2298794049581340238, 6276681651732482293, 8810444192720161397, 17612421071076422764L, 9154251715425171509, 1742887913654569286, 9394635125266914213L, 4744367688521080378, 15016547297373928221L, 16140741669456949734L, 7157363696008454323, 2455778816705608243, 2265494321590199169, 15359291001497268164L, 12677580664494344559L, 17804055298062109087L, 14774836209694478146L, 6206968511317769917, 16346219207651485065L, 5844388477569447782, 13004994715682700264L, 14774343066163640212L, 8009885560487871078, 11903662306684370938L], [10491454686518604657L, 17314897427959903495L, 13913937027202970766L, 2510488534329075511, 14787295713955857550L, 14070327303122026809L, 15331753530566745526L, 7756523409690869201, 13079808574091466295L, 6592508280009581549, 11829221647041131768L, 12043069063879127171L, 15243875893893201838L, 10241812668854962645L, 2027042728372098105, 17171027623451708572L, 18394250120017432289L, 5581685707627588316, 191474449269704686, 6376585056087020805, 9821107783547605035L, 13966858768098659421L, 390177325903892321, 8405986422963034974, 14283573032795395759L, 18280864298189457735L, 15683809075780180116L, 2198130982797811838, 11145819068385583246L, 3991853672394248056], [7197633933169844689, 18156166242131104436L, 8175667207968434950, 4544569293380337867, 6383831012685658713, 1411485421856457193, 12957064701104889272L, 15215448624709817363L, 723358112828388450, 9631148475119423540L, 7458145291279451674, 10572393587336435389L, 403644394978556432, 12757027459102030263L, 2334158072213810604, 6746060328854802610, 260938614207162259, 6648974075169035764, 15518396310851723462L, 3166859931392186076, 4122907636552352717, 842213326130595217, 17553229904297527802L, 9372706243284229305L, 147562639193809506, 12884192542311464862L, 8418355612507396848, 15278525028543662910L, 8840628217028231915, 10163176614812931079L], [329293136196337152, 4590952202174737166, 16794271953504216998L, 2943338523082126512, 5147226844073679981, 24120763696072884, 8897115836874992038, 16814620421030746331L, 946441503647877605, 12789390653131312222L, 11958716781427481197L, 11228742578100699014L, 13905050705304637517L, 2030331832329057784, 14151976259004960527L, 2527477803029104592, 3451888330739713663, 16389600582878484605L, 11618325535459255094L, 925396680396280811, 7770680385222016115, 6245587792032151512, 14973953789288639817L, 2319952390763492951, 12015179320285779385L, 209512541518387166, 10111067505058799511L, 17487679703372099174L, 17352385226472748392L, 7559242109882439215], [13472076777080107148L, 17133365025766035575L, 4069292251243386305, 5172392539921932336, 17599063011507474862L, 16602553229820661294L, 5931761933601006943, 12843230050237393029L, 11012459816104652496L, 10930276100209640527L, 16889779124400280627L, 10312952041019716344L, 18016285954713815250L, 7415712723505438272, 9410295846911249778L, 15752859285134342856L, 7969317215582121033, 8074926364363351562, 13565418250242332127L, 17128569354313909226L, 1177771075171065561, 11125869154422138051L, 17964572022787392953L, 12169653687091236816L, 858605730999292355, 17098891949603890955L, 12813752056603493080L, 13450835450987138042L, 17690444404478108973L, 426251731646410229], [13478007395991009908L, 3406845705018630864, 9655953889720985733L, 17905098665006502875L, 13638842713326254366L, 18070159106973621405L, 686344334615869534, 552733003201679503, 3287658026730617249, 4253988401644372746, 4478205260065835566, 3271690226787488511, 15396344409925976908L, 10758504134345383140L, 14285626609689143358L, 13150640588881430984L, 12808841376062169411L, 5386700651360819368, 6434910495768750770, 11986223620767846389L, 15095369751978133022L, 4719376877500226729, 12372587314056230778L, 745656861994032199, 12103509082692539344L, 14766064741304055623L, 163332223248516449, 17541101106806070718L, 9005556366313397487, 2113524663308814488], [11222598785403026460L, 3832385840062034995, 18429181327009958503L, 17105623995061497242L, 14646900931642679171L, 12843835854525201915L, 378903156299289620, 4720228970810371275, 1655605066362441204, 3725101814693478723, 1476424016377878804, 2919199460130212386, 18427965557607019985L, 16652463777633786656L, 12434752297526508112L, 3495841926932280076, 13383816165283417805L, 15938330719397669665L, 13135291282940562209L, 15391353259380554183L, 17857351618374017613L, 9655834066572643044L, 1662324359049521152, 4713036680400985183, 5851447581746595440, 2623400050096542945, 16958461644659597430L, 3605762752328968926, 9879862267700536788L, 8450242136160431187], [2973276235640002811, 13288212508159338845L, 1713523357538118322, 5316875610378708844, 722843312714244393, 4328808591932786674, 11929831055614004239L, 13547853732926809140L, 2736597244939973827, 2392232373438632550, 14357736238894988180L, 16947075196885416559L, 4837230676539918517, 4844340753523386012, 17298363641705928532L, 4872421297062647, 7152555402203249109, 5362653744655230089, 2972440005621819165, 7156582472906400474, 11497194732935933483L, 11046448067114293474L, 15283205155633984793L, 13925818872323550590L, 2823269450096526518, 8099163153368990720, 203852224550743287, 1842330609623031225, 16893275677625104195L, 3723105010804790357], [10413282939330052876L, 14689666787076498977L, 15678910856020384629L, 13920917986447840102L, 3771711068375982353, 230242519286608076, 6857107951296004557, 10578290888537796044L, 14100612527141024417L, 10116135941613596872L, 15292972394669633947L, 2266719671779599913, 3966346773719642664, 16517802166817901475L, 1578568129355362560, 5402287198740147502, 15215606891537297274L, 9923571702117650496L, 1971666270305735495, 14573251751932964753L, 14706651235587256169L, 12813318719575362443L, 17016169723786097393L, 6100523012097031721, 5948612397517323159, 15758683016106923462L, 10488974465569341823L, 1890318097396562926, 10816940374094883510L, 1244285594945062211], [8197181290526285982, 16976976474743504089L, 14902195237208902433L, 7078725077514186783, 12397068019706613449L, 4592824033088492549, 17651086660154470955L, 2591561104452691399, 17685291810384562201L, 3358585319443398634, 12043597286071979211L, 7217628083023472781, 9658988539481165807L, 9526315412758474104L, 676911211997408152, 3721902651509378712, 11753362168633722832L, 18059086644262808386L, 3973702982075991352, 10095701724349692835L, 15475475428497889998L, 5991267617402983438, 3976509338582598110, 5501812036337793290, 11730462123594246919L, 11058628689072673096L, 4688509684419136644, 3200377490699280492, 12675172721215459711L, 11989754724146666659L], [336693369847031866, 6712391907729037186, 469403504863709714, 14712404004167694554L, 11097205582933181320L, 1847442178254438522, 12311003118860049233L, 1287977261614763776, 9299678554811568781L, 1023513861222948545, 12302564307126598953L, 14305963123258045446L, 4092163740706399449, 781113592536843973, 5578951317285244115, 2486675000417016018, 14714772182528982769L, 15331937855536829380L, 18264977363715002652L, 10767086960611075910L, 12680045197012659661L, 6984320035862906579, 2054304299329904544, 11766589406336728044L, 3182615310255749857, 17572291202973654927L, 3662582337137808017, 4930848862331843755, 114738035485473456, 16315466693681067566L], [16055560610220307707L, 6645406422027833569, 16833591851958165366L, 3686815637286456466, 13771679644626563252L, 6231154409873196877, 15947469979445250530L, 9833396966263788165L, 17285606312682261167L, 10741238347300626796L, 1558103571170387710, 15235137103941251276L, 13547851618382454435L, 10151584433630760956L, 16544709840148998795L, 6425465537462253525, 15726552369825560760L, 6427180466030336293, 3282852607759648290, 10465121615508932489L, 5606552656187146822, 1975146349053874881, 8215596725176206757, 9190883987278938016, 8514891772528571534, 4631901984957725012, 6680804900179846145, 8942293715712285970, 3901662559825798739, 12560742669830849545L], [16778869983960425178L, 6402410729332626243, 4131718592308812129, 8663295714748290229, 5733932631791922710, 12743501238388058313L, 16309455256835649966L, 2651242356890253908, 9249314269268945005L, 7243805620320336753, 10485647205779090381L, 7959959618527467038, 6738128165218861798, 12306595848948678562L, 6697196000227312408, 1934838172781302283, 15853748244575521477L, 14435803410170291288L, 4063323118576309755, 10512565986162973022L, 1928038179660436552, 493979116505069541, 5362364574142236098, 5330681107165937802, 2913760927921191917, 18289276398554970760L, 6911480792424838875, 17784142194497833554L, 16953084079101505205L, 20659688607305201], [6664337699095827062, 7510505831299243966, 4552267683935167037, 2880233136719664300, 11033615863846948521L, 14979929741679888736L, 6664306237806434237, 18325591014674022362L, 4330507839438976713, 5278564724648941954, 6679218387158500001, 13295552857707112769L, 14033601537492389360L, 10438461419373021725L, 3319237379155673318, 8413419180317970123, 15048342041863264445L, 16356198264156365853L, 3996525971170965897, 4601871163144655824, 919537156778256251, 15032168746909665138L, 10673067358927388763L, 5166589369429448610, 16091435236433733665L, 85561132901161845, 6582706210838265145, 16376768321193849466L, 6464248559318731676, 2522216380436290179], [8837497190790535823, 14364133175032242043L, 16547892225379252009L, 14088188319921259339L, 4827079326270202894, 2963595492647482333, 2087132837243534195, 6399993154122646494, 10535353280547883829L, 13617877314076887556L, 11648091583529940696L, 15181921591458763761L, 17991057691291499957L, 14342527029317838012L, 18371574658790885987L, 2815191411598517781, 1986515033976879051, 6611662608340910001, 11398771336309621386L, 15259057624279002917L, 12585272911158208845L, 14257098463703422733L, 7204130957917035830, 3758657208785545402, 12941740521736345593L, 6948938659535967358, 7063166887861766538, 14617353128920164770L, 7709463255750748736, 5883843334655112423], [11860539457137473836L, 15869171874289380948L, 11506129723793625181L, 2075475335936072039, 295226096703618457, 3827861241175461086, 1177604580056059574, 1908732318723550509, 4307266093266579140, 6276326425114202930, 895338409197422175, 7841298693751525386, 2903275023428990426, 15145712516962045425L, 18026898275670754275L, 14264309790771263453L, 14227787579150607578L, 3167635195581741644, 13001579442192732949L, 9888503903880951476L, 7737475909435226401, 7244436033624342133, 9648003565914686116L, 6928623025590175858, 5849775353670328003, 6224364623812070298, 10834126420110555504L, 10359144104410643877L, 6711742112889901937, 2733361570834066729], [831526281832437603, 6350977117014941364, 16038026265797711516L, 7768399778642268385, 3301885869707760232, 13745237952045431282L, 12140703822899604248L, 15073764979045487616L, 5220641468239259840, 15360078651981437007L, 17567055212328571149L, 5363268897519194339, 2927662546454816202, 17459684356462108801L, 10564118301265446448L, 5216725883597855706, 11212573954216170766L, 3999017787617619828, 5417389400909045909, 6833135893967421165, 13281964774736533698L, 3514861510449843692, 15119765742572764514L, 12512874882842890503L, 12018750356338506119L, 17252508747223984529L, 8329450114741836430, 4125455017902529841, 15027219881545563462L, 2805376921015800898], [4571370713821293270, 16832258759749246056L, 2092953203905281363, 3215040668184924563, 3190307485882211045, 1344130221006270228, 7025646649115606626, 10243710740637258313L, 10389411529132800087L, 4014231228503330958, 10012822357198341912L, 7864959747683093728, 16187917023147931535L, 6083224814927431494, 3986976533265541230, 7088155807953983781, 2223158219200331017, 8100486386142457490, 1328970763044834301, 14917873408771553824L, 17288769602307628848L, 4431004453744347997, 7325086701966884391, 16063330157992304448L, 857869239353611803, 14429673196487742823L, 5836712133966257101, 14521848560841164951L, 8431105268846548598, 8239638555427337882], [15012155164094957835L, 3041454915387678852, 10196781678375303328L, 10876438389979491757L, 254129250053071784, 17843605487414700225L, 1888767450836623929, 14622187944013554736L, 5313884163068766866, 721033220909236946, 13640213942915651127L, 4314427523865659019, 10330424310581774196L, 4178245884747264832, 13668612152942240301L, 2485056690251828493, 17294295303535186312L, 2623650095410461114, 3368434740213188389, 9124982687203705889, 432382763179910451, 848782999093044517, 10333360651592600566L, 2051004562685918296, 8045476061734404214, 8483895275054012543, 15165036424980246972L, 2725856813969167001, 8700877275070879271, 9334971787370981124L]]

pk = [6719104775828870677, 11291123617564195730L, 7836093950955107933, 5315381864143362272, 7093928420142884518, 10537623050147769783L, 12927714303751633096L, 8014150504390941814, 17383035616244380802L, 1023081849690671139, 9394779922263104013L, 18224581655374441506L, 3404563851455282120, 6282195633019660932, 13482373970292624343L, 7167134761975396310, 10217177017432339157L, 15158005105325109609L, 12134679049092192476L, 12510405450821042423L, 15596024264550554799L, 11856223887998290285L, 17835004254285909157L, 14804342466199688324L, 15626332169856594783L, 17506428265447904551L, 3775230308981352333, 164488736102425748, 17873118825962176979L, 9510745702398477277L, 10969847454359595874L, 7326876064460535421, 4895727187862453356, 17207218896588702384L, 14570003870167965545L, 7505771908363211076, 6060121099106364282, 11103245140468241530L, 17729636469816808384L, 9781073641617738509L, 12139169713392202642L, 4141836821364870715, 11271261331809832008L, 5982770769373946264, 11219766872875674443L, 13370097814966818029L, 8683218300287894734, 12448549152886996323L, 16703293933958831491L, 3710305500387658746, 8383634977272102400, 4551380077131514702, 15306821694661528528L, 3040914645030389374, 15497012040184331065L, 732637121397013717, 2198560499022227618, 5034602919211704323, 4089180967521026924, 13439466507856612810L, 1871635931404270866, 12793261419751657295L, 2248276431051646363, 13268144881671680513L]
 
# Multiplication by a
mulA = matrix(ZZ, 64, 30)
for i in range(64):
    mulA.set_row(i, list(a[i]))
 
# Basis for the lattice
B = matrix(ZZ, 64+30, 64+30)
B[:64,:64] = Q * identity_matrix(ZZ, 64, 64)
B[64:,:64] = mulA.T
B[64:,64:] = identity_matrix(ZZ, 30, 30)
 
for itr in xrange(100):
    print "Try #%d" % itr
    # randomize lattice
    for i in range(50):
        ia = randint(0, 63)
        ib = randint(0, 63)
        if ib == ia:
            ib = (ib + 1) % 64
        val = randint(-0x80000000, 0x80000000)
        B[ia] += val * B[ib]
 
    print "= LLL + Gram Schmidt"
    M = B.LLL() # delta=0.9999999, eta=0.5)
    G = M.gram_schmidt()[0]
    print "= Done"
 
    target = vector(ZZ, list(pk) + [0] * 30)
    res = Babai_closest_vector(M, G, target)
    delta = res - target
    s0 = vector(ZZ, delta[64:])
    s1 = vector(ZZ, target[:64] - res[:64])
    print "= s0 =", s0
    print "= s1 =", s1
